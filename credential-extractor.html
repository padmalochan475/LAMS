<!DOCTYPE html>
<html>
<head>
    <title>Google Credentials Extractor</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .upload-area { border: 2px dashed #ccc; padding: 40px; text-align: center; margin: 20px 0; border-radius: 10px; }
        .upload-area:hover { border-color: #007cba; background: #f9f9f9; }
        .result { background: #f0f8ff; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .code { background: #333; color: #0f0; padding: 15px; border-radius: 5px; font-family: monospace; white-space: pre-wrap; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; margin: 10px 0; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üîë Google Credentials Extractor</h1>
    
    <div class="warning">
        <strong>‚ö†Ô∏è Security Note:</strong> This tool runs locally in your browser. No data is sent to any server.
    </div>

    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
        <p>üìÅ Click here to upload your Google OAuth JSON file</p>
        <p style="font-size: 12px; color: #666;">The file you downloaded from Google Cloud Console</p>
        <input type="file" id="fileInput" accept=".json" style="display: none;">
    </div>

    <div id="results"></div>

    <script>
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const json = JSON.parse(e.target.result);
                    extractCredentials(json);
                } catch (error) {
                    showError('Invalid JSON file. Please upload the correct Google OAuth credentials file.');
                }
            };
            reader.readAsText(file);
        });

        function extractCredentials(json) {
            let clientId = '';
            let authUri = '';
            let redirectUris = [];

            // Handle different JSON formats
            if (json.web) {
                clientId = json.web.client_id;
                authUri = json.web.auth_uri;
                redirectUris = json.web.redirect_uris || [];
            } else if (json.installed) {
                clientId = json.installed.client_id;
                authUri = json.installed.auth_uri;
                redirectUris = json.installed.redirect_uris || [];
            } else {
                showError('Unrecognized JSON format. Please upload the OAuth credentials file from Google Cloud Console.');
                return;
            }

            if (!clientId) {
                showError('Client ID not found in the JSON file.');
                return;
            }

            showResults(clientId, redirectUris);
        }

        function showResults(clientId, redirectUris) {
            const configCode = `// Updated config.js with your Google credentials
const CONFIG = {
    // Google OAuth Configuration
    GOOGLE_CLIENT_ID: '${clientId}',
    GOOGLE_API_KEY: 'STILL_NEED_TO_CREATE_API_KEY', // Create this in Google Console
    
    // Institute Information
    INSTITUTE_NAME: 'Institute Lab Management System',
    INSTITUTE_LOGO: 'assets/logo.png',
    
    // Admin Configuration
    ADMIN_EMAIL: 'padmalochan475@gmail.com',
    
    // Security Validation
    AUTHORIZED_DOMAIN_HASH: 'a8f5f167f44f4964e6c998dee827110c',
    DEPLOYMENT_FINGERPRINT: 'lams_padma_2024_gh_pages',
    
    // Application Settings
    AUTO_SAVE_INTERVAL: 30000,
    MAX_ASSIGNMENTS_PER_CELL: 10,
    DEFAULT_ACADEMIC_YEAR: '2024-25',
    
    // OAuth Settings
    OAUTH_REDIRECT_URI: window.location.origin,
    OAUTH_SCOPE: 'https://www.googleapis.com/auth/drive.file',
    
    // Print Settings
    PRINT_ORIENTATION: 'landscape',
    PRINT_PAPER_SIZE: 'A4',
    
    // Feature Flags
    FEATURES: {
        GOOGLE_DRIVE_SYNC: true,
        BULK_OPERATIONS: true,
        ANALYTICS: true,
        EXPORT_IMPORT: true
    },
    
    // Security Settings
    SECURITY: {
        DOMAIN_RESTRICTION: true,
        HTTPS_ONLY: true,
        SESSION_TIMEOUT: 24 * 60 * 60 * 1000
    },
    
    // Development mode
    DEV_MODE: false,
    
    // User Management System
    USER_APPROVAL_REQUIRED: true,
    PENDING_USERS_KEY: 'lams_pending_users',
    APPROVED_USERS_KEY: 'lams_approved_users',
    
    // Data Encryption
    ENCRYPT_LOCAL_DATA: true,
    
    // Anti-tampering protection
    VALIDATION_REQUIRED: true,
    BLOCK_UNAUTHORIZED_DEPLOYMENTS: true
};

if (typeof module !== 'undefined' && module.exports) {
    module.exports = CONFIG;
} else {
    window.CONFIG = CONFIG;
}`;

            let html = '<div class="result">';
            html += '<div class="success">‚úÖ Credentials extracted successfully!</div>';
            html += '<h3>Your Client ID:</h3>';
            html += '<code>' + clientId + '</code>';
            
            if (redirectUris.length > 0) {
                html += '<h3>Configured Redirect URIs:</h3>';
                redirectUris.forEach(uri => {
                    html += '<div>‚Ä¢ ' + uri + '</div>';
                });
            }
            
            html += '<h3>Complete config.js file:</h3>';
            html += '<div class="code">' + configCode + '</div>';
            html += '<button onclick="copyToClipboard()">üìã Copy Config</button>';
            html += '<button onclick="downloadConfig()">üíæ Download config.js</button>';
            html += '</div>';

            html += '<div class="warning">';
            html += '<strong>‚ö†Ô∏è Still need to create API Key:</strong><br>';
            html += '1. Go to Google Cloud Console ‚Üí Credentials<br>';
            html += '2. Create Credentials ‚Üí API Key<br>';
            html += '3. Restrict to: https://padmalochan475.github.io/*<br>';
            html += '4. Replace STILL_NEED_TO_CREATE_API_KEY with your API key';
            html += '</div>';

            document.getElementById('results').innerHTML = html;
            window.configCode = configCode;
        }

        function showError(message) {
            document.getElementById('results').innerHTML = 
                '<div class="result"><div class="error">‚ùå ' + message + '</div></div>';
        }

        function copyToClipboard() {
            navigator.clipboard.writeText(window.configCode).then(() => {
                alert('‚úÖ Config copied to clipboard!');
            });
        }

        function downloadConfig() {
            const blob = new Blob([window.configCode], { type: 'text/javascript' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'config.js';
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>